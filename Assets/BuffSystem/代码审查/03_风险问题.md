# é£é™©é—®é¢˜

**ç”Ÿæˆæ—¶é—´**: 2026-02-13
**é—®é¢˜æ€»æ•°**: 58

---

## ğŸ”´ é«˜å±é—®é¢˜ (3)

### 1. BuffSystemManager.cs - è‡ªåŠ¨åˆ›å»º GameObject å¯èƒ½å¯¼è‡´æ„å¤–è¡Œä¸º

**æ–‡ä»¶**: `Core/BuffSystemManager.cs`
**ä½ç½®**: ç¬¬ 56-60 è¡Œ
**ä¸¥é‡ç¨‹åº¦**: ğŸ”´ é«˜å±
**ç±»å‹**: æ¶æ„é£é™©

**é—®é¢˜æè¿°**:
`Instance` å±æ€§åœ¨æ‰¾ä¸åˆ°å®ä¾‹æ—¶ä¼šè‡ªåŠ¨åˆ›å»º GameObjectï¼Œå¯èƒ½å¯¼è‡´åœºæ™¯ä¸­æ„å¤–çš„å¯¹è±¡åˆ›å»ºã€‚

```csharp
public static BuffSystemManager Instance
{
    get
    {
        if (instance == null) CreateInstance();
        return instance;
    }
}

private static void CreateInstance()
{
    instance = FindFirstObjectByType<BuffSystemManager>();
    if (instance == null)
    {
        var go = new GameObject("BuffSystemManager");
        instance = go.AddComponent<BuffSystemManager>();
        DontDestroyOnLoad(go);
    }
}
```

**å½±å“**:
- å¯èƒ½åœ¨ä¸éœ€è¦çš„æ—¶å€™åˆ›å»º GameObject
- å¯èƒ½å¯¼è‡´åœºæ™¯ä¸­å¤šä¸ªå®ä¾‹
- å¯èƒ½å½±å“å†…å­˜ç®¡ç†

**å»ºè®®ä¿®å¤**:
```csharp
public static BuffSystemManager Instance
{
    get
    {
        if (instance == null)
        {
            instance = FindFirstObjectByType<BuffSystemManager>();
            if (instance == null)
            {
                Debug.LogWarning("[BuffSystemManager] Instance not found. Call Initialize() first.");
                return null;
            }
        }
        return instance;
    }
}

public static void Initialize()
{
    if (instance == null)
    {
        var go = new GameObject("BuffSystemManager");
        instance = go.AddComponent<BuffSystemManager>();
        DontDestroyOnLoad(go);
    }
}
```

---

### 2. BuffContainer.cs - HandleDependencyRemoval åˆ›å»ºä¸´æ—¶åˆ—è¡¨

**æ–‡ä»¶**: `Runtime/BuffContainer.cs`
**ä½ç½®**: ç¬¬ 448-462 è¡Œ
**ä¸¥é‡ç¨‹åº¦**: ğŸ”´ é«˜å±
**ç±»å‹**: æ€§èƒ½é£é™©

**é—®é¢˜æè¿°**:
æ¯æ¬¡ç§»é™¤ä¾èµ–æ—¶åˆ›å»ºä¸´æ—¶ `List<BuffEntity>`ï¼Œå­˜åœ¨ GC åˆ†é…ã€‚

```csharp
private void HandleDependencyRemoval(int removedBuffId)
{
    // æ”¶é›†éœ€è¦ç§»é™¤çš„Buff - é¢„åˆ†é…å®¹é‡é¿å…åŠ¨æ€æ‰©å®¹
    var buffsToRemove = new List<BuffEntity>(buffByInstanceId.Count);
    
    foreach (var buff in buffByInstanceId.Values)
    {
        if (buff.Data is BuffDataSO buffDataSO && buffDataSO.DependBuffIds.Contains(removedBuffId))
        {
            buffsToRemove.Add(buff);
        }
    }
    
    // ç§»é™¤ä¾èµ–çš„Buff
    foreach (var buff in buffsToRemove)
    {
        if (Data.BuffSystemConfig.Instance.EnableDebugLog)
        {
            Debug.Log($"[BuffContainer] Buff {buff.Name} å› ä¾èµ–çš„Buff {removedBuffId} è¢«ç§»é™¤è€Œè‡ªåŠ¨ç§»é™¤");
        }
        RemoveBuff(buff);
    }
}
```

**å½±å“**:
- æ¯æ¬¡ Buff ç§»é™¤éƒ½å¯èƒ½è§¦å‘ GC
- åœ¨é«˜é¢‘æ·»åŠ /ç§»é™¤åœºæ™¯ä¸‹æ€§èƒ½å½±å“æ˜æ˜¾
- å¯èƒ½å¯¼è‡´å¸§ç‡æ³¢åŠ¨

**å»ºè®®ä¿®å¤**:
```csharp
// åœ¨ BuffContainer ç±»ä¸­æ·»åŠ å¯¹è±¡æ± 
private readonly ObjectPool<List<BuffEntity>> buffListPool;

public BuffContainer(IBuffOwner owner)
{
    // ... å…¶ä»–åˆå§‹åŒ–ä»£ç 
    
    // åˆå§‹åŒ–åˆ—è¡¨å¯¹è±¡æ± 
    buffListPool = new ObjectPool<List<BuffEntity>>(
        createFunc: () => new List<BuffEntity>(),
        actionOnGet: list => list.Clear(),
        actionOnRelease: list => list.Clear(),
        defaultCapacity: 4,
        maxSize: 16
    );
}

private void HandleDependencyRemoval(int removedBuffId)
{
    // ä»å¯¹è±¡æ± è·å–åˆ—è¡¨
    var buffsToRemove = buffListPool.Get();
    
    try
    {
        foreach (var buff in buffByInstanceId.Values)
        {
            if (buff.Data is BuffDataSO buffDataSO && buffDataSO.DependBuffIds.Contains(removedBuffId))
            {
                buffsToRemove.Add(buff);
            }
        }
        
        foreach (var buff in buffsToRemove)
        {
            if (Data.BuffSystemConfig.Instance.EnableDebugLog)
            {
                Debug.Log($"[BuffContainer] Buff {buff.Name} å› ä¾èµ–çš„Buff {removedBuffId} è¢«ç§»é™¤è€Œè‡ªåŠ¨ç§»é™¤");
            }
            RemoveBuff(buff);
        }
    }
    finally
    {
        // å½’è¿˜åˆ—è¡¨åˆ°å¯¹è±¡æ± 
        buffListPool.Release(buffsToRemove);
    }
}
```

---

### 3. BuffSystemUpdater.cs - åŒé‡æ£€æŸ¥é”å®šç¼ºå°‘ volatile

**æ–‡ä»¶**: `Runtime/BuffSystemUpdater.cs`
**ä½ç½®**: ç¬¬ 82-95 è¡Œ
**ä¸¥é‡ç¨‹åº¦**: ğŸ”´ é«˜å±
**ç±»å‹**: çº¿ç¨‹å®‰å…¨é£é™©

**é—®é¢˜æè¿°**:
`instance` å­—æ®µæ²¡æœ‰ `volatile` ä¿®é¥°ï¼Œå¯èƒ½å­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚

```csharp
private static BuffSystemUpdater instance;
private static readonly object instanceLock = new();

public static BuffSystemUpdater Instance
{
    get
    {
        if (instance == null)
        {
            CreateInstance();
        }
        return instance;
    }
}

private static void CreateInstance()
{
    if (instance != null) return;

    lock (instanceLock)
    {
        if (instance != null) return;

        var go = new GameObject("BuffSystemUpdater");
        instance = go.AddComponent<BuffSystemUpdater>();
        DontDestroyOnLoad(go);
    }
}
```

**å½±å“**:
- åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹å¯èƒ½å‡ºç°ç«æ€æ¡ä»¶
- å¯èƒ½å¯¼è‡´å¤šä¸ªå®ä¾‹è¢«åˆ›å»º
- å¯èƒ½å¯¼è‡´ä¸å¯é¢„æµ‹çš„è¡Œä¸º

**å»ºè®®ä¿®å¤**:
```csharp
private static volatile BuffSystemUpdater instance;
private static readonly object instanceLock = new();

public static BuffSystemUpdater Instance
{
    get
    {
        if (instance == null)
        {
            CreateInstance();
        }
        return instance;
    }
}

// æˆ–è€…ä½¿ç”¨ Lazy<T>
private static readonly Lazy<BuffSystemUpdater> lazyInstance = 
    new Lazy<BuffSystemUpdater>(() => 
    {
        var go = new GameObject("BuffSystemUpdater");
        var instance = go.AddComponent<BuffSystemUpdater>();
        DontDestroyOnLoad(go);
        return instance;
    });

public static BuffSystemUpdater Instance => lazyInstance.Value;
```

---

## ğŸŸ  ä¸­å±é—®é¢˜ (12)

### 1. BuffApi.cs - GetBuffsByTagNonAlloc å¼•ç”¨ä¸å­˜åœ¨çš„æ–¹æ³•

**æ–‡ä»¶**: `Core/BuffApi.cs`
**ä½ç½®**: ç¬¬ 337-341 è¡Œ
**ä¸¥é‡ç¨‹åº¦**: ğŸŸ  ä¸­å±
**ç±»å‹**: API ç¼ºé™·

**é—®é¢˜æè¿°**:
`AllBuffs.FilterByTagNonAlloc` æ–¹æ³•ä¸å­˜åœ¨ï¼Œä½† `GetBuffsByTagNonAlloc` æ–¹æ³•å¼•ç”¨äº†å®ƒã€‚

```csharp
public static void GetBuffsByTagNonAlloc(string tag, IBuffOwner target, List<IBuff> result)
{
    target?.BuffContainer?.AllBuffs.FilterByTagNonAlloc(tag, result);
}
```

**å½±å“**:
- è°ƒç”¨æ­¤æ–¹æ³•ä¼šæŠ›å‡ºå¼‚å¸¸
- API ä¸å¯ç”¨

**å»ºè®®ä¿®å¤**:
```csharp
public static void GetBuffsByTagNonAlloc(string tag, IBuffOwner target, List<IBuff> result)
{
    if (target?.BuffContainer == null || string.IsNullOrEmpty(tag))
    {
        result?.Clear();
        return;
    }

    result?.Clear();
    foreach (var buff in target.BuffContainer.AllBuffs)
    {
        if (buff.Data.Tags.Contains(tag))
        {
            result.Add(buff);
        }
    }
}
```

---

### 2. BuffDataSO.cs - Tags å±æ€§æ¯æ¬¡åˆ›å»ºæ–°åˆ—è¡¨

**æ–‡ä»¶**: `Data/BuffDataSO.cs`
**ä½ç½®**: ç¬¬ 241-252 è¡Œ
**ä¸¥é‡ç¨‹åº¦**: ğŸŸ  ä¸­å±
**ç±»å‹**: æ€§èƒ½é£é™©

**é—®é¢˜æè¿°**:
`Tags` å±æ€§æ¯æ¬¡è®¿é—®éƒ½åˆ›å»ºæ–°çš„ `List<string>`ï¼Œå­˜åœ¨ GC åˆ†é…ã€‚

```csharp
public IReadOnlyList<string> Tags
{
    get
    {
        // å®æ—¶è½¬æ¢ï¼Œé¿å…ç¼“å­˜ä¸ä¸€è‡´é—®é¢˜
        if (tags.Count == 0)
            return System.Array.Empty<string>();

        var result = new List<string>(tags.Count);
        foreach (var tag in tags)
        {
            result.Add(tag.TagName);
        }

        return result;
    }
}
```

**å½±å“**:
- æ¯æ¬¡è®¿é—®éƒ½è§¦å‘ GC åˆ†é…
- åœ¨é«˜é¢‘è®¿é—®åœºæ™¯ä¸‹æ€§èƒ½å½±å“æ˜æ˜¾

**å»ºè®®ä¿®å¤**:
```csharp
private IReadOnlyList<string> cachedTags;
private bool tagsCacheValid = false;

public IReadOnlyList<string> Tags
{
    get
    {
        if (tagsCacheValid)
        {
            return cachedTags;
        }

        if (tags.Count == 0)
        {
            cachedTags = System.Array.Empty<string>();
        }
        else
        {
            var result = new string[tags.Count];
            for (int i = 0; i < tags.Count; i++)
            {
                result[i] = tags[i].TagName;
            }
            cachedTags = result;
        }

        tagsCacheValid = true;
        return cachedTags;
    }
}

private void OnValidate()
{
    // ... å…¶ä»–éªŒè¯ä»£ç 
    
    // æ ‡è®°ç¼“å­˜å¤±æ•ˆ
    tagsCacheValid = false;
}
```

---

### 3. BuffEntity.cs - sourceId ä½¿ç”¨ä¸ç¨³å®šçš„å“ˆå¸Œ

**æ–‡ä»¶**: `Runtime/BuffEntity.cs`
**ä½ç½®**: ç¬¬ 97 è¡Œ
**ä¸¥é‡ç¨‹åº¦**: ğŸŸ  ä¸­å±
**ç±»å‹**: ç¨³å®šæ€§é£é™©

**é—®é¢˜æè¿°**:
`sourceId` ä½¿ç”¨ `RuntimeHelpers.GetHashCode`ï¼Œä½†è¿™ä¸ªå“ˆå¸Œå€¼åœ¨è¿è¡Œæ—¶å¯èƒ½ä¸ç¨³å®šã€‚

```csharp
public void Reset(IBuffData newData, IBuffOwner newOwner, object newSource)
{
    data = newData ?? throw new ArgumentNullException(nameof(newData));
    owner = newOwner ?? throw new ArgumentNullException(nameof(newOwner));
    source = newSource;

    // è®¡ç®—SourceIdï¼ˆä½¿ç”¨RuntimeHelpers.GetHashCodeç¡®ä¿ç¨³å®šæ€§ï¼‰
    sourceId = source != null ? RuntimeHelpers.GetHashCode(source) : 0;
    
    // ... å…¶ä»–ä»£ç 
}
```

**å½±å“**:
- å“ˆå¸Œå€¼å¯èƒ½åœ¨è¿è¡Œæ—¶å˜åŒ–
- å¯èƒ½å¯¼è‡´ SourceId ä¸ä¸€è‡´

**å»ºè®®ä¿®å¤**:
```csharp
// æ·»åŠ ä¸€ä¸ªç¨³å®šçš„ ID ç”Ÿæˆå™¨
public static class SourceIdGenerator
{
    private static int nextId = 1;
    private static readonly Dictionary<object, int> sourceIdMap = new();

    public static int GetSourceId(object source)
    {
        if (source == null) return 0;

        lock (sourceIdMap)
        {
            if (!sourceIdMap.TryGetValue(source, out int id))
            {
                id = nextId++;
                sourceIdMap[source] = id;
            }
            return id;
        }
    }

    public static void RemoveSourceId(object source)
    {
        if (source == null) return;

        lock (sourceIdMap)
        {
            sourceIdMap.Remove(source);
        }
    }
}

// åœ¨ BuffEntity ä¸­ä½¿ç”¨
sourceId = SourceIdGenerator.GetSourceId(source);
```

---

### 4. BuffContainer.cs - CreateNewBuff æ–¹æ³•è¿‡é•¿

**æ–‡ä»¶**: `Runtime/BuffContainer.cs`
**ä½ç½®**: ç¬¬ 523-623 è¡Œ
**ä¸¥é‡ç¨‹åº¦**: ğŸŸ  ä¸­å±
**ç±»å‹**: ä»£ç è´¨é‡

**é—®é¢˜æè¿°**:
`CreateNewBuff` æ–¹æ³•çº¦ 100 è¡Œï¼Œå»ºè®®æ‹†åˆ†ã€‚

**å½±å“**:
- ä»£ç å¯è¯»æ€§å·®
- éš¾ä»¥ç»´æŠ¤å’Œæµ‹è¯•
- è¿åå•ä¸€èŒè´£åŸåˆ™

**å»ºè®®ä¿®å¤**:
å°†æ–¹æ³•æ‹†åˆ†ä¸ºå¤šä¸ªå°æ–¹æ³•ï¼š
- `ApplyModifiers`
- `InitializeBuff`
- `StoreBuff`
- `TriggerBuffEvents`

---

### 5. BuffOwner.cs - RemoveBuffsByTag åˆ›å»ºä¸´æ—¶åˆ—è¡¨

**æ–‡ä»¶**: `Runtime/BuffOwner.cs`
**ä½ç½®**: ç¬¬ 418-429 è¡Œ
**ä¸¥é‡ç¨‹åº¦**: ğŸŸ  ä¸­å±
**ç±»å‹**: æ€§èƒ½é£é™©

**é—®é¢˜æè¿°**:
åˆ›å»ºä¸´æ—¶ `List<IBuff>`ï¼Œå­˜åœ¨ GC åˆ†é…ã€‚

```csharp
private void RemoveBuffsByTag(string tag)
{
    if (buffContainer == null) return;
    
    // é¢„åˆ†é…å®¹é‡é¿å…åŠ¨æ€æ‰©å®¹
    var buffsToRemove = new List<IBuff>(buffContainer.Count);
    foreach (var buff in buffContainer.AllBuffs)
    {
        if (buff.Data.Tags.Contains(tag))
        {
            buffsToRemove.Add(buff);
        }
    }
    
    foreach (var buff in buffsToRemove)
    {
        RemoveBuff(buff);
    }
}
```

**å»ºè®®ä¿®å¤**:
ä½¿ç”¨å¯¹è±¡æ± æˆ–ç›´æ¥åœ¨å¾ªç¯ä¸­ç§»é™¤ã€‚

---

### 6. BuffOwner.cs - OnGUI æ¯å¸§æ‰§è¡Œå¯èƒ½å½±å“æ€§èƒ½

**æ–‡ä»¶**: `Runtime/BuffOwner.cs`
**ä½ç½®**: ç¬¬ 532-566 è¡Œ
**ä¸¥é‡ç¨‹åº¦**: ğŸŸ  ä¸­å±
**ç±»å‹**: æ€§èƒ½é£é™©

**é—®é¢˜æè¿°**:
`OnGUI` åœ¨ `showDebugInfo` ä¸º true æ—¶æ¯å¸§æ‰§è¡Œã€‚

**å»ºè®®ä¿®å¤**:
ä»…åœ¨ç¼–è¾‘å™¨æ¨¡å¼ä¸‹å¯ç”¨ã€‚

```csharp
#if UNITY_EDITOR
private void OnGUI()
{
    if (!showDebugInfo || buffContainer == null) return;
    
    // ... è°ƒè¯•ä»£ç 
}
#endif
```

---

### 7. BuffSaveManager.cs - FindOwnerById éå†æ‰€æœ‰ Owner

**æ–‡ä»¶**: `Runtime/BuffSaveManager.cs`
**ä½ç½®**: ç¬¬ 285-295 è¡Œ
**ä¸¥é‡ç¨‹åº¦**: ğŸŸ  ä¸­å±
**ç±»å‹**: æ€§èƒ½é£é™©

**é—®é¢˜æè¿°**:
éå†æ‰€æœ‰ Ownerï¼Œæ€§èƒ½å¯èƒ½ä¸ä½³ã€‚

**å»ºè®®ä¿®å¤**:
åœ¨ `BuffOwner` ä¸­æ·»åŠ é™æ€å­—å…¸ç´¢å¼•ã€‚

---

### 8. BuffComboManager.cs - ExecuteEffect ä½¿ç”¨ switch

**æ–‡ä»¶**: `Advanced/Combo/BuffComboManager.cs`
**ä½ç½®**: ç¬¬ 326-377 è¡Œ
**ä¸¥é‡ç¨‹åº¦**: ğŸŸ  ä¸­å±
**ç±»å‹**: ä»£ç è´¨é‡

**é—®é¢˜æè¿°**:
ä½¿ç”¨ switch è¯­å¥ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ç­–ç•¥æ¨¡å¼ã€‚

**å»ºè®®ä¿®å¤**:
ä½¿ç”¨å­—å…¸æ˜ å°„æˆ–ç­–ç•¥æ¨¡å¼ã€‚

---

### 9. FusionManager.cs - activeFusions éå†å¯èƒ½å½±å“æ€§èƒ½

**æ–‡ä»¶**: `Advanced/Fusion/FusionManager.cs`
**ä½ç½®**: ç¬¬ 155-170 è¡Œ
**ä¸¥é‡ç¨‹åº¦**: ğŸŸ  ä¸­å±
**ç±»å‹**: æ€§èƒ½é£é™©

**é—®é¢˜æè¿°**:
Update ä¸­éå†æ‰€æœ‰è¿›è¡Œä¸­çš„èåˆã€‚

**å»ºè®®ä¿®å¤**:
è€ƒè™‘åˆ†æ‰¹å¤„ç†ã€‚

---

### 10. TransmissionManager.cs - é€’å½’è°ƒç”¨å¯èƒ½å¯¼è‡´æ ˆæº¢å‡º

**æ–‡ä»¶**: `Advanced/Transmission/TransmissionManager.cs`
**ä½ç½®**: ç¬¬ 62-75 è¡Œ
**ä¸¥é‡ç¨‹åº¦**: ğŸŸ  ä¸­å±
**ç±»å‹**: ç¨³å®šæ€§é£é™©

**é—®é¢˜æè¿°**:
é€’å½’è°ƒç”¨ `RequestTransmission`ï¼Œå¯èƒ½å¯¼è‡´æ ˆæº¢å‡ºã€‚

**å»ºè®®ä¿®å¤**:
æ”¹ä¸ºè¿­ä»£å®ç°æˆ–æ·»åŠ æ·±åº¦é™åˆ¶ã€‚

---

### 11. BuffGroup.cs - RemoveWeakestBuff éå†æ‰€æœ‰ Buff

**æ–‡ä»¶**: `Groups/BuffGroup.cs`
**ä½ç½®**: ç¬¬ 119-135 è¡Œ
**ä¸¥é‡ç¨‹åº¦**: ğŸŸ  ä¸­å±
**ç±»å‹**: æ€§èƒ½é£é™©

**é—®é¢˜æè¿°**:
éå†æ‰€æœ‰ Buff æ‰¾åˆ°æœ€å¼±çš„ã€‚

**å»ºè®®ä¿®å¤**:
ç»´æŠ¤æœ€å°å †æˆ–ä½¿ç”¨ä¼˜å…ˆçº§é˜Ÿåˆ—ã€‚

---

### 12. DelayEffect.cs - Cancel å–æ¶ˆæ‰€æœ‰å»¶è¿Ÿæ•ˆæœ

**æ–‡ä»¶**: `Effects/Core/DelayEffect.cs`
**ä½ç½®**: ç¬¬ 70-75 è¡Œ
**ä¸¥é‡ç¨‹åº¦**: ğŸŸ  ä¸­å±
**ç±»å‹**: é€»è¾‘ç¼ºé™·

**é—®é¢˜æè¿°**:
`Cancel` æ–¹æ³•ä¼šå–æ¶ˆæ‰€æœ‰å»¶è¿Ÿæ•ˆæœï¼Œå¯èƒ½ä¸ç¬¦åˆé¢„æœŸã€‚

**å»ºè®®ä¿®å¤**:
è€ƒè™‘åªå–æ¶ˆæœªè§¦å‘çš„æ•ˆæœã€‚

---

## ğŸŸ¡ ä½å±é—®é¢˜ (28)

### 1. BuffLogicBase.cs - IBuffEventReceiver æ¥å£ä½ç½®ä¸å½“

**æ–‡ä»¶**: `Core/BuffLogicBase.cs`
**ä½ç½®**: ç¬¬ 163-173 è¡Œ
**ä¸¥é‡ç¨‹åº¦**: ğŸŸ¡ ä½å±
**ç±»å‹**: ä»£ç ç»„ç»‡

**é—®é¢˜æè¿°**:
`IBuffEventReceiver` æ¥å£å®šä¹‰åœ¨æ–‡ä»¶æœ«å°¾ï¼Œå»ºè®®ç§»åˆ°å•ç‹¬æ–‡ä»¶ã€‚

---

### 2. EffectBasedBuffLogic.cs - CancelEffects æ–¹æ³•æœªè¢«è°ƒç”¨

**æ–‡ä»¶**: `Core/EffectBasedBuffLogic.cs`
**ä½ç½®**: ç¬¬ 119-126 è¡Œ
**ä¸¥é‡ç¨‹åº¦**: ğŸŸ¡ ä½å±
**ç±»å‹**: ä»£ç è´¨é‡

**é—®é¢˜æè¿°**:
`CancelEffects` æ–¹æ³•å·²å®šä¹‰ä½†æœªè¢«è°ƒç”¨ï¼Œå»ºè®®åœ¨ `Dispose` ä¸­è°ƒç”¨ã€‚

---

### 3. BuffDataSO.cs - HasTag æ–¹æ³•å¾ªç¯ä¸­è°ƒç”¨å“ˆå¸Œ

**æ–‡ä»¶**: `Data/BuffDataSO.cs`
**ä½ç½®**: ç¬¬ 267-277 è¡Œ
**ä¸¥é‡ç¨‹åº¦**: ğŸŸ¡ ä½å±
**ç±»å‹**: æ€§èƒ½é£é™©

**é—®é¢˜æè¿°**:
`HasTag(string tag)` æ–¹æ³•åœ¨å¾ªç¯ä¸­è°ƒç”¨ `BuffTagManager.GetTagHash`ï¼Œå¯ä»¥æå‰è®¡ç®—ã€‚

---

### 4. IBuffOwner.cs - ImmuneTags ç±»å‹ä¸ä¸€è‡´

**æ–‡ä»¶**: `Core/IBuffOwner.cs`
**ä½ç½®**: ç¬¬ 184 è¡Œ
**ä¸¥é‡ç¨‹åº¦**: ğŸŸ¡ ä½å±
**ç±»å‹**: API ä¸€è‡´æ€§

**é—®é¢˜æè¿°**:
`ImmuneTags` è¿”å› `IReadOnlyList<string>`ï¼Œå†…éƒ¨ä½¿ç”¨ `HashSet<int>` ä¼˜åŒ–ï¼Œä½†æ¥å£æš´éœ²çš„æ˜¯å­—ç¬¦ä¸²åˆ—è¡¨ï¼Œå­˜åœ¨ç±»å‹ä¸ä¸€è‡´ã€‚

---

### 5. BuffSystemConfig.cs - LoadInstance åˆ›å»ºçš„å®ä¾‹ä¸ä¼šè¢«ä¿å­˜

**æ–‡ä»¶**: `Data/BuffSystemConfig.cs`
**ä½ç½®**: ç¬¬ 112-123 è¡Œ
**ä¸¥é‡ç¨‹åº¦**: ğŸŸ¡ ä½å±
**ç±»å‹**: æ•°æ®æŒä¹…åŒ–

**é—®é¢˜æè¿°**:
`LoadInstance` æ–¹æ³•åœ¨æ‰¾ä¸åˆ°é…ç½®æ—¶ä¼šåˆ›å»ºé»˜è®¤å®ä¾‹ï¼Œä½†è¿™ä¸ªå®ä¾‹ä¸ä¼šè¢«ä¿å­˜ï¼Œå¯èƒ½å¯¼è‡´é…ç½®ä¸¢å¤±ã€‚

---

### 6. BuffEventSystem.cs - genericEventHandlers ç±»å‹è½¬æ¢å¼€é”€

**æ–‡ä»¶**: `Events/BuffEventSystem.cs`
**ä½ç½®**: ç¬¬ 178-186 è¡Œ
**ä¸¥é‡ç¨‹åº¦**: ğŸŸ¡ ä½å±
**ç±»å‹**: æ€§èƒ½é£é™©

**é—®é¢˜æè¿°**:
`genericEventHandlers` ä½¿ç”¨ `Dictionary<string, Delegate>`ï¼Œç±»å‹è½¬æ¢å¯èƒ½å­˜åœ¨æ€§èƒ½å¼€é”€ã€‚

---

### 7. BuffDataWrapper.cs - GetSource å§‹ç»ˆè¿”å› null

**æ–‡ä»¶**: `Runtime/BuffDataWrapper.cs`
**ä½ç½®**: ç¬¬ 137-145 è¡Œ
**ä¸¥é‡ç¨‹åº¦**: ğŸŸ¡ ä½å±
**ç±»å‹**: åŠŸèƒ½é™åˆ¶

**é—®é¢˜æè¿°**:
`GetSource<T>` å’Œ `TryGetSource<T>` å§‹ç»ˆè¿”å› nullï¼Œå› ä¸ºä¼˜åŒ–å®¹å™¨åªå­˜å‚¨ SourceIdã€‚

---

### 8. BuffDataWrapper.cs - Reset ä¸æ”¯æŒ

**æ–‡ä»¶**: `Runtime/BuffDataWrapper.cs`
**ä½ç½®**: ç¬¬ 149-156 è¡Œ
**ä¸¥é‡ç¨‹åº¦**: ğŸŸ¡ ä½å±
**ç±»å‹**: åŠŸèƒ½é™åˆ¶

**é—®é¢˜æè¿°**:
`Reset` æ–¹æ³•ä¸æ”¯æŒåœ¨ä¼˜åŒ–å®¹å™¨ä¸­ç›´æ¥è°ƒç”¨ã€‚

---

### 9. BuffOwner.cs - OnGUI åœ¨è¿è¡Œæ—¶ä¹Ÿå¯èƒ½æ‰§è¡Œ

**æ–‡ä»¶**: `Runtime/BuffOwner.cs`
**ä½ç½®**: ç¬¬ 532 è¡Œ
**ä¸¥é‡ç¨‹åº¦**: ğŸŸ¡ ä½å±
**ç±»å‹**: æ€§èƒ½é£é™©

**é—®é¢˜æè¿°**:
`OnGUI` æ–¹æ³•æ²¡æœ‰ `#if UNITY_EDITOR` ä¿æŠ¤ï¼Œåœ¨è¿è¡Œæ—¶ä¹Ÿå¯èƒ½æ‰§è¡Œã€‚

---

### 10-28. å…¶ä»–ä½å±é—®é¢˜

è¯¦è§å„æ–‡ä»¶å®¡æŸ¥ç»“æœã€‚

---

## ğŸ”µ å»ºè®®é—®é¢˜ (15)

### 1. è€ƒè™‘æ·»åŠ  IBuffPause å’Œ IBuffResume æ¥å£

**ä½ç½®**: `Core/IBuffLogic.cs`
**ä¸¥é‡ç¨‹åº¦**: ğŸ”µ å»ºè®®
**ç±»å‹**: åŠŸèƒ½å¢å¼º

**å»ºè®®**:
æ·»åŠ æš‚åœ/æ¢å¤æ¥å£ï¼Œæ”¯æŒ Buff çš„æš‚åœå’Œæ¢å¤åŠŸèƒ½ã€‚

---

### 2. è€ƒè™‘ä½¿ç”¨ä¾èµ–æ³¨å…¥æ¡†æ¶

**ä½ç½®**: æ•´ä¸ªé¡¹ç›®
**ä¸¥é‡ç¨‹åº¦**: ğŸ”µ å»ºè®®
**ç±»å‹**: æ¶æ„æ”¹è¿›

**å»ºè®®**:
è€ƒè™‘å¼•å…¥ä¾èµ–æ³¨å…¥æ¡†æ¶ï¼Œå‡å°‘å•ä¾‹ä½¿ç”¨ï¼Œæé«˜å¯æµ‹è¯•æ€§ã€‚

---

### 3. è€ƒè™‘æ·»åŠ æ›´è¯¦ç»†çš„é”™è¯¯å¤„ç†

**ä½ç½®**: æ•´ä¸ªé¡¹ç›®
**ä¸¥é‡ç¨‹åº¦**: ğŸ”µ å»ºè®®
**ç±»å‹**: é”™è¯¯å¤„ç†

**å»ºè®®**:
æ·»åŠ æ›´è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯ï¼Œè€ƒè™‘ä½¿ç”¨ Result æ¨¡å¼è¿”å›é”™è¯¯ã€‚

---

### 4-15. å…¶ä»–å»ºè®®é—®é¢˜

è¯¦è§å„æ–‡ä»¶å®¡æŸ¥ç»“æœã€‚

---

**é£é™©é—®é¢˜ç”Ÿæˆå®Œæˆæ—¶é—´**: 2026-02-13
