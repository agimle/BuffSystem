# æ¨èä¼˜åŒ–æµç¨‹ v9.0

## ä¼˜åŒ–æ¦‚è¿°
åŸºäºä»£ç å®¡æŸ¥ç»“æœï¼Œæä¾›åˆ†é˜¶æ®µçš„ä¼˜åŒ–å»ºè®®å’Œå®æ–½æµç¨‹ã€‚

---

## ä¼˜åŒ–ä¼˜å…ˆçº§

### ğŸ”´ é«˜ä¼˜å…ˆçº§ï¼ˆç«‹å³ä¿®å¤ï¼‰
1. é«˜çº§åŠŸèƒ½å±‚ä¾èµ–è¿è¡Œæ—¶å®ç°å±‚
2. ç­–ç•¥å±‚ä¾èµ–å…·ä½“å®ç°

### ğŸŸ¡ ä¸­ä¼˜å…ˆçº§ï¼ˆè¿‘æœŸä¿®å¤ï¼‰
3. ç¼–è¾‘å™¨ä»£ç æ··å…¥è¿è¡Œæ—¶å‘½åç©ºé—´
4. Tags å±æ€§å®æ—¶è½¬æ¢å¯èƒ½å¯¼è‡´æ€§èƒ½é—®é¢˜

### ğŸŸ¢ ä½ä¼˜å…ˆçº§ï¼ˆé•¿æœŸä¼˜åŒ–ï¼‰
5. éƒ¨åˆ†ç±»èŒè´£è¿‡é‡
6. å•ä¾‹æ¨¡å¼æ»¥ç”¨

---

## é˜¶æ®µ1: é«˜ä¼˜å…ˆçº§ä¿®å¤ï¼ˆç«‹å³æ‰§è¡Œï¼‰

### ä¿®å¤1: é«˜çº§åŠŸèƒ½å±‚ä¾èµ–è¿è¡Œæ—¶å®ç°å±‚

**å½±å“æ–‡ä»¶**:
- `BuffComboManager.cs`
- `FusionManager.cs`
- `TransmissionManager.cs`

**é—®é¢˜**:
é«˜çº§åŠŸèƒ½å±‚ç›´æ¥ä¾èµ–è¿è¡Œæ—¶å®ç°å±‚ï¼ˆBuffEntityã€BuffContainerã€BuffOwnerï¼‰ï¼Œè¿åäº†ä¾èµ–å€’ç½®åŸåˆ™ã€‚

**ä¿®å¤æ­¥éª¤**:

#### æ­¥éª¤1: åœ¨ IBuff æ¥å£ä¸­æ·»åŠ å¿…è¦æ–¹æ³•
```csharp
// IBuff.cs
public interface IBuff
{
    // ... ç°æœ‰å±æ€§å’Œæ–¹æ³•

    /// <summary>
    /// åˆ·æ–°æŒç»­æ—¶é—´
    /// </summary>
    void RefreshDuration();

    /// <summary>
    /// å¢åŠ å±‚æ•°
    /// </summary>
    void AddStack(int amount);

    /// <summary>
    /// å‡å°‘å±‚æ•°
    /// </summary>
    void RemoveStack(int amount);
}
```

#### æ­¥éª¤2: ä¿®å¤ BuffComboManager.cs
```csharp
// ä¿®å¤å‰ï¼ˆé”™è¯¯ï¼‰
if (buff is BuffEntity entity)
{
    entity.RefreshDuration();
}

// ä¿®å¤åï¼ˆæ­£ç¡®ï¼‰
buff.RefreshDuration();
```

#### æ­¥éª¤3: ä¿®å¤ FusionManager.cs
```csharp
// ä¿®å¤å‰ï¼ˆé”™è¯¯ï¼‰
if (buff is BuffEntity entity)
{
    entity.AddStack(Mathf.Max(1, amount));
}

// ä¿®å¤åï¼ˆæ­£ç¡®ï¼‰
buff.AddStack(Mathf.Max(1, amount));
```

#### æ­¥éª¤4: ä¿®å¤ TransmissionManager.cs
```csharp
// ä¿®å¤å‰ï¼ˆé”™è¯¯ï¼‰
if (owner is BuffOwner buffOwner)
{
    // ç›´æ¥ä½¿ç”¨ BuffOwner çš„æ–¹æ³•
}

// ä¿®å¤åï¼ˆæ­£ç¡®ï¼‰
// ä½¿ç”¨ IBuffOwner æ¥å£æ–¹æ³•
```

**é¢„æœŸæ•ˆæœ**:
- é«˜çº§åŠŸèƒ½å±‚åªä¾èµ– Core æ¥å£å±‚
- æé«˜ç³»ç»Ÿå¯æµ‹è¯•æ€§
- é™ä½æ¶æ„è€¦åˆåº¦

**æµ‹è¯•éªŒè¯**:
1. è¿è¡Œç°æœ‰å•å…ƒæµ‹è¯•
2. æµ‹è¯• Combo ç³»ç»ŸåŠŸèƒ½
3. æµ‹è¯• Fusion ç³»ç»ŸåŠŸèƒ½
4. æµ‹è¯• Transmission ç³»ç»ŸåŠŸèƒ½

---

### ä¿®å¤2: ç­–ç•¥å±‚ä¾èµ–å…·ä½“å®ç°

**å½±å“æ–‡ä»¶**:
- `BuffStrategy.cs` (ReduceStackStrategy)

**é—®é¢˜**:
ç­–ç•¥å±‚ç›´æ¥ä¾èµ– BuffEntityï¼Œè¿åäº†ç­–ç•¥æ¨¡å¼åŸåˆ™ã€‚

**ä¿®å¤æ­¥éª¤**:

#### æ­¥éª¤1: åœ¨ IBuff æ¥å£ä¸­æ·»åŠ  RemoveStack æ–¹æ³•
```csharp
// IBuff.cs
public interface IBuff
{
    // ... ç°æœ‰å±æ€§å’Œæ–¹æ³•

    /// <summary>
    /// å‡å°‘å±‚æ•°
    /// </summary>
    void RemoveStack(int amount);
}
```

#### æ­¥éª¤2: ä¿®å¤ ReduceStackStrategy.cs
```csharp
// ä¿®å¤å‰ï¼ˆé”™è¯¯ï¼‰
if (buff is BuffEntity entity)
{
    entity.RemoveStack(buff.Data.RemoveStackCount);
}

// ä¿®å¤åï¼ˆæ­£ç¡®ï¼‰
buff.RemoveStack(buff.Data.RemoveStackCount);
```

**é¢„æœŸæ•ˆæœ**:
- ç­–ç•¥åªä¾èµ– IBuff æ¥å£
- ç­–ç•¥å¯ä»¥ç”¨äºä»»ä½• IBuff å®ç°
- æé«˜ç³»ç»Ÿæ‰©å±•æ€§

**æµ‹è¯•éªŒè¯**:
1. è¿è¡Œç°æœ‰å•å…ƒæµ‹è¯•
2. æµ‹è¯•å„ç§å å±‚ç­–ç•¥
3. æµ‹è¯•å„ç§ç§»é™¤ç­–ç•¥

---

## é˜¶æ®µ2: ä¸­ä¼˜å…ˆçº§ä¿®å¤ï¼ˆè¿‘æœŸæ‰§è¡Œï¼‰

### ä¿®å¤3: ç¼–è¾‘å™¨ä»£ç æ··å…¥è¿è¡Œæ—¶å‘½åç©ºé—´

**å½±å“æ–‡ä»¶**:
- `BuffDataSO.cs`

**é—®é¢˜**:
è¿è¡Œæ—¶ç¨‹åºé›†åŒ…å«ç¼–è¾‘å™¨æ¡ä»¶ç¼–è¯‘ä»£ç ï¼Œè¿åäº†ç¼–è¾‘å™¨ä»£ç éš”ç¦»åŸåˆ™ã€‚

**ä¿®å¤æ­¥éª¤**:

#### æ­¥éª¤1: åˆ›å»º BuffDataSO.Editor.cs
```csharp
// BuffDataSO.Editor.cs
#if UNITY_EDITOR
using UnityEditor;
using UnityEngine;

namespace BuffSystem.Data
{
    public partial class BuffDataSO
    {
        [Header("æ¨¡æ¿ç»§æ‰¿")]
        [Tooltip("åŸºç¡€æ¨¡æ¿")]
        [SerializeField] private BuffTemplate baseTemplate;

        [Tooltip("æ˜¯å¦ç»§æ‰¿æ¨¡æ¿å€¼")]
        [SerializeField] private bool inheritFromTemplate = true;

        /// <summary>
        /// åŸºç¡€æ¨¡æ¿
        /// </summary>
        public BuffTemplate BaseTemplate => baseTemplate;

        /// <summary>
        /// æ˜¯å¦ç»§æ‰¿æ¨¡æ¿
        /// </summary>
        public bool InheritFromTemplate => inheritFromTemplate;

        /// <summary>
        /// åº”ç”¨æ¨¡æ¿ï¼ˆå¦‚æœé…ç½®äº†æ¨¡æ¿ä¸”å…è®¸ç»§æ‰¿ï¼‰
        /// </summary>
        public void ApplyTemplate()
        {
            if (baseTemplate != null && inheritFromTemplate)
            {
                baseTemplate.ApplyTemplate(this, false);
            }
        }

        /// <summary>
        /// è®¾ç½®IDï¼ˆæ¨¡æ¿ç³»ç»Ÿä½¿ç”¨ï¼‰
        /// </summary>
        public void SetId(int value) => id = value;

        /// <summary>
        /// è®¾ç½®åç§°ï¼ˆæ¨¡æ¿ç³»ç»Ÿä½¿ç”¨ï¼‰
        /// </summary>
        public void SetName(string value) => buffName = value;

        /// <summary>
        /// è®¾ç½®æ•ˆæœç±»å‹ï¼ˆæ¨¡æ¿ç³»ç»Ÿä½¿ç”¨ï¼‰
        /// </summary>
        public void SetEffectType(BuffEffectType value) => effectType = value;

        /// <summary>
        /// è®¾ç½®æ˜¯å¦å”¯ä¸€ï¼ˆæ¨¡æ¿ç³»ç»Ÿä½¿ç”¨ï¼‰
        /// </summary>
        public void SetIsUnique(bool value) => isUnique = value;

        /// <summary>
        /// è®¾ç½®å åŠ æ¨¡å¼ï¼ˆæ¨¡æ¿ç³»ç»Ÿä½¿ç”¨ï¼‰
        /// </summary>
        public void SetStackMode(BuffStackMode value) => stackMode = value;

        /// <summary>
        /// è®¾ç½®æœ€å¤§å±‚æ•°ï¼ˆæ¨¡æ¿ç³»ç»Ÿä½¿ç”¨ï¼‰
        /// </summary>
        public void SetMaxStack(int value) => maxStack = Mathf.Max(1, value);

        /// <summary>
        /// è®¾ç½®æ·»åŠ å±‚æ•°ï¼ˆæ¨¡æ¿ç³»ç»Ÿä½¿ç”¨ï¼‰
        /// </summary>
        public void SetAddStackCount(int value) => addStackCount = Mathf.Max(1, value);

        /// <summary>
        /// è®¾ç½®æ˜¯å¦æ°¸ä¹…ï¼ˆæ¨¡æ¿ç³»ç»Ÿä½¿ç”¨ï¼‰
        /// </summary>
        public void SetIsPermanent(bool value) => isPermanent = value;

        /// <summary>
        /// è®¾ç½®æŒç»­æ—¶é—´ï¼ˆæ¨¡æ¿ç³»ç»Ÿä½¿ç”¨ï¼‰
        /// </summary>
        public void SetDuration(float value) => duration = Mathf.Max(0.1f, value);

        /// <summary>
        /// è®¾ç½®æ˜¯å¦å¯åˆ·æ–°ï¼ˆæ¨¡æ¿ç³»ç»Ÿä½¿ç”¨ï¼‰
        /// </summary>
        public void SetCanRefresh(bool value) => canRefresh = value;

        /// <summary>
        /// è®¾ç½®ç§»é™¤æ¨¡å¼ï¼ˆæ¨¡æ¿ç³»ç»Ÿä½¿ç”¨ï¼‰
        /// </summary>
        public void SetRemoveMode(BuffRemoveMode value) => removeMode = value;

        /// <summary>
        /// è®¾ç½®ç§»é™¤å±‚æ•°ï¼ˆæ¨¡æ¿ç³»ç»Ÿä½¿ç”¨ï¼‰
        /// </summary>
        public void SetRemoveStackCount(int value) => removeStackCount = Mathf.Max(1, value);

        /// <summary>
        /// è®¾ç½®ç§»é™¤é—´éš”ï¼ˆæ¨¡æ¿ç³»ç»Ÿä½¿ç”¨ï¼‰
        /// </summary>
        public void SetRemoveInterval(float value) => removeInterval = Mathf.Max(0f, value);

        /// <summary>
        /// è®¾ç½®äº’æ–¥ä¼˜å…ˆçº§ï¼ˆæ¨¡æ¿ç³»ç»Ÿä½¿ç”¨ï¼‰
        /// </summary>
        public void SetMutexPriority(MutexPriority value) => mutexPriority = value;

        /// <summary>
        /// æ·»åŠ ç»„é…ç½®ï¼ˆæ¨¡æ¿ç³»ç»Ÿä½¿ç”¨ï¼‰
        /// </summary>
        public void AddGroupConfig(BuffGroupConfigEntry config)
        {
            if (config != null && !string.IsNullOrEmpty(config.groupId))
            {
                groupConfigs.Add(config);
            }
        }

        /// <summary>
        /// æ·»åŠ æ ‡ç­¾ï¼ˆæ¨¡æ¿ç³»ç»Ÿä½¿ç”¨ï¼‰
        /// </summary>
        public void AddTag(BuffTag tag)
        {
            if (!tags.Contains(tag))
            {
                tags.Add(tag);
            }
        }

        /// <summary>
        /// è®¾ç½®æ›´æ–°é¢‘ç‡ï¼ˆæ¨¡æ¿ç³»ç»Ÿä½¿ç”¨ï¼‰
        /// </summary>
        public void SetUpdateFrequency(UpdateFrequency value) => updateFrequency = value;

        private void OnValidate()
        {
            // ç¡®ä¿IDä¸ä¸º0
            if (id == 0)
            {
                // ç”ŸæˆåŸºäºåç§°çš„å“ˆå¸ŒID
                id = Mathf.Abs(buffName.GetHashCode());
            }

            // ç¡®ä¿æ•°å€¼åˆæ³•
            maxStack = Mathf.Max(1, maxStack);
            addStackCount = Mathf.Max(1, addStackCount);
            removeStackCount = Mathf.Max(1, removeStackCount);
            duration = Mathf.Max(0.1f, duration);
            removeInterval = Mathf.Max(0f, removeInterval);

            // åº”ç”¨æ¨¡æ¿ï¼ˆä»…åœ¨ç¼–è¾‘å™¨ä¸­ä¸”é…ç½®äº†æ¨¡æ¿æ—¶ï¼‰
            if (baseTemplate != null && inheritFromTemplate)
            {
                ApplyTemplate();
            }
        }
    }
}
#endif
```

#### æ­¥éª¤2: ä» BuffDataSO.cs ä¸­ç§»é™¤ç¼–è¾‘å™¨ä»£ç 
```csharp
// BuffDataSO.cs (è¿è¡Œæ—¶)
public partial class BuffDataSO : ScriptableObject, IBuffData
{
    // åªä¿ç•™è¿è¡Œæ—¶ä»£ç 
    // ç§»é™¤æ‰€æœ‰ #if UNITY_EDITOR ä»£ç å—
}
```

**é¢„æœŸæ•ˆæœ**:
- è¿è¡Œæ—¶ç¨‹åºé›†ä¸åŒ…å«ç¼–è¾‘å™¨ä»£ç 
- ç¬¦åˆç¼–è¾‘å™¨ä»£ç éš”ç¦»åŸåˆ™
- é¿å…æ„å»ºé”™è¯¯

**æµ‹è¯•éªŒè¯**:
1. æ„å»ºè¿è¡Œæ—¶ç¨‹åºé›†
2. æµ‹è¯•ç¼–è¾‘å™¨åŠŸèƒ½æ­£å¸¸
3. æµ‹è¯•è¿è¡Œæ—¶åŠŸèƒ½æ­£å¸¸

---

### ä¿®å¤4: Tags å±æ€§å®æ—¶è½¬æ¢å¯èƒ½å¯¼è‡´æ€§èƒ½é—®é¢˜

**å½±å“æ–‡ä»¶**:
- `BuffDataSO.cs`

**é—®é¢˜**:
æ¯æ¬¡è®¿é—® Tags å±æ€§éƒ½åˆ›å»ºæ–°çš„ List<string> å®ä¾‹ï¼Œé«˜é¢‘è°ƒç”¨ä¼šå¯¼è‡´GCå‹åŠ›ã€‚

**ä¿®å¤æ­¥éª¤**:

#### æ­¥éª¤1: æ·»åŠ ç¼“å­˜æœºåˆ¶
```csharp
// BuffDataSO.cs
public partial class BuffDataSO : ScriptableObject, IBuffData
{
    // ... ç°æœ‰å­—æ®µ

    // ç¼“å­˜å­—æ®µ
    [NonSerialized] private List<string> cachedTags;
    [NonSerialized] private int tagsVersion;

    /// <summary>
    /// æ ‡ç­¾åˆ—è¡¨ï¼ˆå­—ç¬¦ä¸²å½¢å¼ï¼Œå…¼å®¹æ—§æ¥å£ï¼‰
    /// </summary>
    public IReadOnlyList<string> Tags
    {
        get
        {
            if (tags.Count == 0)
                return System.Array.Empty<string>();

            // æ£€æŸ¥ç¼“å­˜æ˜¯å¦æœ‰æ•ˆ
            if (cachedTags == null || tagsVersion != GetTagsVersion())
            {
                cachedTags = new List<string>(tags.Count);
                foreach (var tag in tags)
                {
                    cachedTags.Add(tag.TagName);
                }
                tagsVersion = GetTagsVersion();
            }

            return cachedTags;
        }
    }

    /// <summary>
    /// è·å–æ ‡ç­¾ç‰ˆæœ¬å·
    /// </summary>
    private int GetTagsVersion()
    {
        // ä½¿ç”¨ tags.Count ä½œä¸ºç‰ˆæœ¬å·
        return tags.Count;
    }

    /// <summary>
    /// æ ‡è®°æ ‡ç­¾å·²ä¿®æ”¹
    /// </summary>
    private void OnTagsChanged()
    {
        tagsVersion++;
        cachedTags = null;
    }
}
```

#### æ­¥éª¤2: åœ¨ä¿®æ”¹ tags æ—¶æ›´æ–°ç‰ˆæœ¬å·
```csharp
// BuffDataSO.Editor.cs
#if UNITY_EDITOR
public partial class BuffDataSO
{
    /// <summary>
    /// æ·»åŠ æ ‡ç­¾ï¼ˆæ¨¡æ¿ç³»ç»Ÿä½¿ç”¨ï¼‰
    /// </summary>
    public void AddTag(BuffTag tag)
    {
        if (!tags.Contains(tag))
        {
            tags.Add(tag);
            OnTagsChanged(); // æ·»åŠ æ­¤è¡Œ
        }
    }
}
#endif
```

**é¢„æœŸæ•ˆæœ**:
- å‡å°‘ GC åˆ†é…
- æé«˜é«˜é¢‘è®¿é—®æ€§èƒ½
- ç¼“å­˜è‡ªåŠ¨å¤±æ•ˆæœºåˆ¶ä¿è¯æ•°æ®ä¸€è‡´æ€§

**æµ‹è¯•éªŒè¯**:
1. ä½¿ç”¨ Profiler æµ‹è¯• GC åˆ†é…
2. æµ‹è¯•æ ‡ç­¾è®¿é—®æ€§èƒ½
3. æµ‹è¯•æ ‡ç­¾ä¿®æ”¹åç¼“å­˜å¤±æ•ˆ

---

## é˜¶æ®µ3: ä½ä¼˜å…ˆçº§ä¼˜åŒ–ï¼ˆé•¿æœŸæ‰§è¡Œï¼‰

### ä¼˜åŒ–5: éƒ¨åˆ†ç±»èŒè´£è¿‡é‡

**å½±å“æ–‡ä»¶**:
- `BuffContainer.cs` (1024+ è¡Œ)
- `BuffOwner.cs` (670+ è¡Œ)
- `BuffComboManager.cs` (677+ è¡Œ)

**é—®é¢˜**:
å•ä¸€ç±»æ‰¿æ‹…è¿‡å¤šèŒè´£ï¼Œè¿åå•ä¸€èŒè´£åŸåˆ™ï¼Œéš¾ä»¥ç»´æŠ¤å’Œæµ‹è¯•ã€‚

**ä¼˜åŒ–æ­¥éª¤**:

#### æ­¥éª¤1: æ‹†åˆ† BuffContainer.cs
```csharp
// BuffContainerCore.cs - æ ¸å¿ƒBuffç®¡ç†
public partial class BuffContainer : IBuffContainer
{
    // æ ¸å¿ƒBuffç®¡ç†é€»è¾‘
}

// BuffContainerIndexing.cs - ç´¢å¼•ç®¡ç†
public partial class BuffContainer
{
    // å¤šå­—å…¸ç´¢å¼•ç®¡ç†
}

// BuffContainerGroups.cs - Buffç»„ç®¡ç†
public partial class BuffContainer
{
    // Buffç»„ç®¡ç†é€»è¾‘
}

// BuffContainerModifiers.cs - ä¿®é¥°å™¨å¤„ç†
public partial class BuffContainer
{
    // ä¿®é¥°å™¨å¤„ç†é€»è¾‘
}

// BuffContainerDependencies.cs - ä¾èµ–å…³ç³»å¤„ç†
public partial class BuffContainer
{
    // ä¾èµ–å’Œäº’æ–¥å…³ç³»å¤„ç†
}
```

#### æ­¥éª¤2: æ‹†åˆ† BuffOwner.cs
```csharp
// BuffOwnerCore.cs - æ ¸å¿ƒåŠŸèƒ½
public partial class BuffOwner : MonoBehaviour, IBuffOwner
{
    // æ ¸å¿ƒåŠŸèƒ½
}

// BuffOwnerImmunity.cs - å…ç–«ç³»ç»Ÿ
public partial class BuffOwner
{
    // å…ç–«ç³»ç»Ÿé€»è¾‘
}

// BuffOwnerCombo.cs - Comboç³»ç»Ÿ
public partial class BuffOwner
{
    // Comboç³»ç»Ÿé€»è¾‘
}

// BuffOwnerDebug.cs - è°ƒè¯•åŠŸèƒ½
public partial class BuffOwner
{
    // è°ƒè¯•åŠŸèƒ½
}
```

#### æ­¥éª¤3: æ‹†åˆ† BuffComboManager.cs
```csharp
// BuffComboManagerCore.cs - æ ¸å¿ƒåŠŸèƒ½
public partial class BuffComboManager : MonoBehaviour
{
    // æ ¸å¿ƒComboç®¡ç†
}

// BuffComboManagerRegistration.cs - æ³¨å†Œç®¡ç†
public partial class BuffComboManager
{
    // Comboæ³¨å†Œé€»è¾‘
}

// BuffComboManagerActivation.cs - æ¿€æ´»ç®¡ç†
public partial class BuffComboManager
{
    // Comboæ¿€æ´»é€»è¾‘
}

// BuffComboManagerEffects.cs - æ•ˆæœæ‰§è¡Œ
public partial class BuffComboManager
{
    // æ•ˆæœæ‰§è¡Œé€»è¾‘
}
```

**é¢„æœŸæ•ˆæœ**:
- æ¯ä¸ªç±»èŒè´£å•ä¸€
- æé«˜å¯ç»´æŠ¤æ€§
- æé«˜å¯æµ‹è¯•æ€§

**æµ‹è¯•éªŒè¯**:
1. è¿è¡Œç°æœ‰å•å…ƒæµ‹è¯•
2. æµ‹è¯•æ‰€æœ‰åŠŸèƒ½æ­£å¸¸
3. æµ‹è¯•æ€§èƒ½æ— å›é€€

---

### ä¼˜åŒ–6: å•ä¾‹æ¨¡å¼æ»¥ç”¨

**å½±å“æ–‡ä»¶**:
- `BuffDatabase.cs`
- `BuffSystemConfig.cs`
- `BuffSystemManager.cs`
- `BuffSystemUpdater.cs`
- `BuffComboManager.cs`

**é—®é¢˜**:
è¿‡å¤šå•ä¾‹å¯¼è‡´å…¨å±€çŠ¶æ€ï¼Œéš¾ä»¥è¿›è¡Œå•å…ƒæµ‹è¯•ï¼Œç”Ÿå‘½å‘¨æœŸç®¡ç†å¤æ‚ã€‚

**ä¼˜åŒ–æ­¥éª¤**:

#### æ­¥éª¤1: å¼•å…¥ä¾èµ–æ³¨å…¥å®¹å™¨
```csharp
// BuffServiceLocator.cs
public static class BuffServiceLocator
{
    private static readonly Dictionary<Type, object> services = new();

    public static void Register<T>(T service) where T : class
    {
        services[typeof(T)] = service;
    }

    public static T Get<T>() where T : class
    {
        if (services.TryGetValue(typeof(T), out var service))
        {
            return (T)service;
        }
        return null;
    }

    public static void Clear()
    {
        services.Clear();
    }
}
```

#### æ­¥éª¤2: ä¿®æ”¹ BuffDatabase ä½¿ç”¨ä¾èµ–æ³¨å…¥
```csharp
// BuffDatabase.cs
public class BuffDatabase
{
    private static BuffDatabase instance;
    public static BuffDatabase Instance
    {
        get
        {
            if (instance == null)
            {
                instance = new BuffDatabase();
            }
            return instance;
        }
    }

    // ä¿ç•™å•ä¾‹æ¨¡å¼ï¼Œä½†å¯ä»¥é€šè¿‡ BuffServiceLocator è®¿é—®
}
```

#### æ­¥éª¤3: åœ¨åˆå§‹åŒ–æ—¶æ³¨å†ŒæœåŠ¡
```csharp
// BuffSystemInitializer.cs
public class BuffSystemInitializer : MonoBehaviour
{
    private void Awake()
    {
        // æ³¨å†ŒæœåŠ¡
        BuffServiceLocator.Register(BuffDatabase.Instance);
        BuffServiceLocator.Register(BuffSystemConfig.Instance);
        BuffServiceLocator.Register(BuffSystemManager.Instance);
        BuffServiceLocator.Register(BuffSystemUpdater.Instance);
    }
}
```

**é¢„æœŸæ•ˆæœ**:
- å‡å°‘å…¨å±€çŠ¶æ€
- æé«˜å¯æµ‹è¯•æ€§
- æ›´çµæ´»çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†

**æµ‹è¯•éªŒè¯**:
1. è¿è¡Œç°æœ‰å•å…ƒæµ‹è¯•
2. æµ‹è¯•ä¾èµ–æ³¨å…¥åŠŸèƒ½
3. æµ‹è¯•æ‰€æœ‰åŠŸèƒ½æ­£å¸¸

---

## ä¼˜åŒ–æ—¶é—´è¡¨

### ç¬¬1å‘¨: é«˜ä¼˜å…ˆçº§ä¿®å¤
- Day 1-2: ä¿®å¤é«˜çº§åŠŸèƒ½å±‚ä¾èµ–è¿è¡Œæ—¶å®ç°å±‚
- Day 3-4: ä¿®å¤ç­–ç•¥å±‚ä¾èµ–å…·ä½“å®ç°
- Day 5: æµ‹è¯•éªŒè¯

### ç¬¬2å‘¨: ä¸­ä¼˜å…ˆçº§ä¿®å¤
- Day 1-2: ä¿®å¤ç¼–è¾‘å™¨ä»£ç æ··å…¥è¿è¡Œæ—¶å‘½åç©ºé—´
- Day 3-4: ä¿®å¤ Tags å±æ€§å®æ—¶è½¬æ¢æ€§èƒ½é—®é¢˜
- Day 5: æµ‹è¯•éªŒè¯

### ç¬¬3-4å‘¨: ä½ä¼˜å…ˆçº§ä¼˜åŒ–
- Week 3: æ‹†åˆ†èŒè´£è¿‡é‡çš„ç±»
- Week 4: ä¼˜åŒ–å•ä¾‹æ¨¡å¼
- æµ‹è¯•éªŒè¯

---

## ä¼˜åŒ–éªŒè¯æ¸…å•

### åŠŸèƒ½éªŒè¯
- [ ] æ‰€æœ‰ç°æœ‰åŠŸèƒ½æ­£å¸¸å·¥ä½œ
- [ ] å•å…ƒæµ‹è¯•å…¨éƒ¨é€šè¿‡
- [ ] é›†æˆæµ‹è¯•å…¨éƒ¨é€šè¿‡
- [ ] ç¼–è¾‘å™¨åŠŸèƒ½æ­£å¸¸
- [ ] è¿è¡Œæ—¶åŠŸèƒ½æ­£å¸¸

### æ€§èƒ½éªŒè¯
- [ ] GC åˆ†é…æ— å¢åŠ 
- [ ] å¸§ç‡æ— ä¸‹é™
- [ ] å†…å­˜ä½¿ç”¨æ— å¢åŠ 
- [ ] åŠ è½½æ—¶é—´æ— å¢åŠ 

### æ¶æ„éªŒè¯
- [ ] ä¾èµ–å…³ç³»æ¸…æ™°
- [ ] æ¥å£ä¸å®ç°åˆ†ç¦»
- [ ] å•ä¸€èŒè´£åŸåˆ™
- [ ] å¼€é—­åŸåˆ™
- [ ] é‡Œæ°æ›¿æ¢åŸåˆ™

### æ–‡æ¡£éªŒè¯
- [ ] ä»£ç æ³¨é‡Šå®Œæ•´
- [ ] API æ–‡æ¡£æ›´æ–°
- [ ] å˜æ›´æ—¥å¿—æ›´æ–°

---

## æ€»ç»“

æœ¬ä¼˜åŒ–æµç¨‹æŒ‰ç…§ä¼˜å…ˆçº§åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼š

1. **é˜¶æ®µ1ï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰**: ä¿®å¤æ¶æ„è¿è§„é—®é¢˜ï¼Œæé«˜ç³»ç»Ÿå¯æµ‹è¯•æ€§å’Œæ‰©å±•æ€§
2. **é˜¶æ®µ2ï¼ˆä¸­ä¼˜å…ˆçº§ï¼‰**: ä¿®å¤ä»£ç éš”ç¦»å’Œæ€§èƒ½é—®é¢˜ï¼Œæé«˜ä»£ç è´¨é‡å’Œæ€§èƒ½
3. **é˜¶æ®µ3ï¼ˆä½ä¼˜å…ˆçº§ï¼‰**: ä¼˜åŒ–ä»£ç ç»„ç»‡å’Œæ¶æ„ï¼Œæé«˜å¯ç»´æŠ¤æ€§

å»ºè®®æŒ‰ç…§æ—¶é—´è¡¨é€æ­¥æ‰§è¡Œï¼Œæ¯ä¸ªé˜¶æ®µå®Œæˆåè¿›è¡Œå……åˆ†æµ‹è¯•éªŒè¯ã€‚
